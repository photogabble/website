{% extends "layouts/page.njk" %}

{% set page_class = 'page__list' %}
{% set type = tags | specialTagValue('type') %}

{% if sidebar_items %}
    {% set items = sidebar_items %}
{% elseif sidebar_topic === 'stage/stub' %}
    {% set items = collections[sidebar_topic] | reverse %}
{% else %}
    {% set items = collections[sidebar_topic] | notTagged('stage/stub') | reverse %}
{% endif %}

{% block content %}
<article>
    <header>
        <div class="article-header__category filled-boxes">
            <span><a href="#">{{ type }}</a></span>
        </div>

        <div class="article-header__meta">
            <span>{{ items.length }} items,</span> last updated on 1st Jan, 2025
        </div>

        <h1 class="article-header__title">{{ title }}</h1>

        <hr/>

        <div class="article-header__stats">
            <a href="/stubs">Stubs</a>, Seedlings, Budding, Evergreen, Ephemeral
        </div>
    </header>

    {% if content.length > 0 %}
    <section class="article-section__content">
        {% if abstract %}<p class="article-section__content-abstract">{{ abstract }}</p>{% endif %}
        <div class="article-section__content-content">{{ content | safe }}</div>
        <aside id="sidenote-column-right" class="article-section__content-ref">
            <div>
                First Published: {{ page.date | dateToFormat('DDD') }} in commit <a href="#">########</a>.<br/>
                Updated: Never<br/>
                {% if reviewed %}Reviewed: {{ reviewed | dateToFormat('DDD') }}{% endif %}
            </div>
        </aside>
    </section>
    <hr>
    {% endif %}

    <section class="list-section">
        {%- for post in items -%}
            <article>
                <div>
                    <header>
                        <h3><a href="{{ post.url }}" title="Read {{ post.data.title }}">{{ post.data.title }}</a></h3>
                        <small>~267 words, about a 2 min read</small>
                    </header>
                    <div></div>
                    <footer>
                        <small>{% if post.data.growthStage === 'stub' %}Due {% else %}Planted {% endif %}{{ post.data.niceDate or post.date | dateToFormat("DDD") }}</small>
                    </footer>
                </div>
            </article>
        {%- endfor -%}
{#        {% include "components/side-bars/topic.njk" %}#}
    </section>

    <hr>

    <footer>
        {% if backlinks.length %}
            <div id="backlinks">
                <h3>Pages Linking Here <a class="header-anchor" href="#backlinks">Â¶</a></h3>
                <ul>{% for link in backlinks %}<li><a href="{{ link.url }}">{{ link.title }}</a></li>{% endfor %}</ul>
            </div>
        {% endif %}
    </footer>
</article>
{% endblock %}
